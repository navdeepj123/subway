name: Deploy Web App to Server

on:
  push:
    branches:
      - main  # Deploy on push to main branch (or your desired branch)

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v3

    - name: Install Dependencies
      run: |
        # Install dependencies if you need to, like npm install
        npm install

    - name: Deploy to Server (without Docker)
      run: |
        # Copy your project files directly to the server using SCP
        # You can add specific files or folders you need for your deployment
        scp -r ./ ${SERVER_USER}@${SERVER_IP}:/path/to/your/deployment/directory/

    - name: SSH into Server and Set Up
      run: |
        # SSH into the server and perform any post-deployment setup
        sshpass -p "${{ secrets.SERVER_PASSWORD }}" ssh -o StrictHostKeyChecking=no ${SERVER_USER}@${SERVER_IP} "
          cd /path/to/your/deployment/directory/
          npm install  # If you need to install dependencies on the server
          pm2 restart your-app  # If you use PM2 or any other process manager
        "
